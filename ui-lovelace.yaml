title: Home
# custom_header:
#   compact_mode: true
#   button_text:
#     # options: '{{dayNameShort}} {{year4d}}-{{monthNumLZ}}-{{dayNumLZ}}<br>{{ hours24LZ }}:{{ minutesLZ }}'
#     options: '{{dayNameShort}} {{monthNameShort}} {{dayNum}}<br>{{hours24LZ}}:{{minutesLZ}}'
# swipe_nav:
#   wrap: true
#   animate: flip
#   skip_tabs:
#   swipe_amount: 15
views:
  - title: Main
    icon: mdi:home-assistant
    cards:

      - type: vertical-stack
        cards:
          - type: alarm-panel
            states:
              - arm_home
              - arm_away
            entity: alarm_control_panel.alarm
          - type: grid
            square: false
            cards:
              # - type: light
              #   entity: light.upstairs_lights
              - type: light
                entity: light.bedroom_lights
                name: Bedroom
              # - type: light
              #   entity: light.downstairs_lights
              - type: light
                entity: light.dining_room_lamp
                name: Dining
              - type: light
                entity: light.living_room_lights
                name: Living
              - type: light
                entity: light.lamp
              - type: light
                entity: light.hallway
              - type: light
                entity: light.porch
              - type: button
                entity: switch.downstairs_plug
              - type: button
                entity: switch.upstairs_plug
      - type: vertical-stack
        cards:
          - type: 'custom:simple-thermostat'
            entity: climate.downstairs
            step_size: 0.1
            decimals: 1
            step_layout: row
            fallback: ' '
            control:
              _names: true
              _headings: false
              hvac: 
                heat_cool: false
              preset: true
          - type: 'custom:simple-thermostat'
            entity: climate.upstairs
            step_size: 0.1
            decimals: 1
            step_layout: row
            fallback: ' '
            control:
              _names: true
              _headings: false
              hvac: 
                heat_cool: false
              preset: true
      - type: vertical-stack
        cards:
          - type: picture-entity
            title: front
            entity: camera.front

          - type: picture-entity
            title: back
            entity: camera.back

  - panel: true
    title: Tablet
    icon: 'mdi:tablet'
    badges: []
    cards:
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: alarm-panel
                    states:
                      - arm_home
                      - arm_away
                    entity: alarm_control_panel.alarm
                  - type: grid
                    square: false
                    cards:
                      # - type: light
                      #   entity: light.upstairs_lights
                      - type: light
                        entity: light.bedroom_lights
                        name: Bedroom
                      # - type: light
                      #   entity: light.downstairs_lights
                      - type: light
                        entity: light.dining_room_lamp
                        name: Dining
                      - type: light
                        entity: light.living_room_lights
                        name: Living
                      - type: button
                        entity: switch.downstairs_plug
                      - type: light
                        entity: light.hallway
                      - type: light
                        entity: light.porch
              - type: vertical-stack
                cards:
                  - type: weather-forecast
                    entity: weather.openweathermap
                  - type: horizontal-stack
                    cards:
                      - type: picture-entity
                        title: front
                        entity: camera.front

                      - type: picture-entity
                        title: back
                        entity: camera.back
          - type: horizontal-stack
            cards:
              - type: 'custom:mini-graph-card'
                entities:
                  - entity: sensor.solar_now_watts
                    name: Power
                    show_state: true
                  - entity: sensor.solar_elevation
                    name: Elevation
                    line_width: 1
                    show_fill: false
                    show_state: false
                    y_axis: secondary
                    color: '#666666'
                  - entity: sensor.openweathermap_cloud_coverage
                    name: Cloud Cover
                    line_width: 1
                    show_fill: false
                    show_state: true
                    y_axis: secondary
                hour24: true
                hours_to_show: 48
                points_per_hour: 15
                line_width: 1
                lower_bound_secondary: 0
                # group_by: hour
                show:
                  extrema: true
                  average: true
                  graph: true
                  points: false
                  legend: false
              - type: 'custom:mini-graph-card'
                entities:
                  - entity: sensor.solar_today_kwh
                    name: Daily Energy
                aggregate_func: max
                lower_bound: 0
                upper_bound: 50
                hour24: true
                hours_to_show: 168
                points_per_hour: 1
                group_by: date
                show:
                  extrema: true
                  average: true
                  graph: bar
  - title: Solar
    icon: 'mdi:solar-power'
    panel: false
    cards:
      - type: 'custom:mini-graph-card'
        entities:
          - entity: sensor.solar_now_watts
          # - entity: sensor.envoy_122020046917_current_energy_production
            name: Power
            show_state: true
          - entity: sensor.solar_elevation
            name: Elevation
            line_width: 1
            show_fill: false
            show_state: false
            y_axis: secondary
            color: '#666666'
          - entity: sensor.openweathermap_cloud_coverage
            name: Cloud Cover
            line_width: 1
            show_fill: false
            show_state: true
            y_axis: secondary
        hour24: true
        icon: mdi:solar-panel-large
        hours_to_show: 48
        points_per_hour: 15
        line_width: 1
        lower_bound_secondary: 0
        # group_by: hour
        show:
          extrema: true
          average: true
          graph: true
          points: false
          legend: false
      - type: 'custom:mini-graph-card'
        entities:
          # - entity: sensor.solar_daily_energy
          - entity: sensor.solar_today_kwh
            name: Daily Energy
        aggregate_func: max
        hour24: true
        hours_to_show: 168
        points_per_hour: 1
        group_by: date
        icon: mdi:solar-panel-large
        lower_bound: 0
        upper_bound: 50
        show:
          extrema: true
          average: true
          graph: bar
      - type: grid
        columns: 2
        square: false
        cards:
          - type: sensor
            entity: sensor.solar_lifetime_mwh
            icon: mdi:solar-panel-large
          - type: sensor
            name: Solar Last 7 Days
            entity: sensor.solar_week_kwh
            icon: mdi:solar-panel
          - type: sensor
            entity: sensor.moon

      - type: 'custom:sun-card'
        showElevation: true
        showAzimuth: true
        timeFormat: '24h'

  - title: Cameras
    icon: 'mdi:cctv'
    panel: true
    cards:
      - type: grid
        columns: 2
        square: false
        cards:
          - type: picture-entity
            title: front
            entity: camera.front

          - type: picture-entity
            title: back
            entity: camera.back
  - title: Weather
    icon: mdi:weather-sunny
    cards:
      - type: vertical-stack
        cards:
          - type: weather-forecast
            entity: weather.openweathermap
          # - type: picture-entity
          #   entity: camera.radar_dc_current
          - type: picture-entity
            entity: camera.radar_dc_animated
      - type: vertical-stack
        cards:
          - type: 'custom:mini-graph-card'
            name: Temperature
            entities:
              - entity: sensor.downstairs_temperature
                name: Downstairs
                show_state: true
                state_adaptive_color: true
              - entity: sensor.upstairs_temperature
                name: Upstairs
                show_state: true
                state_adaptive_color: true
              - entity: sensor.ecobee_outside_temperature
                name: Outside
                show_state: true
                state_adaptive_color: true
              - color: '#666666'
                entity: sensor.solar_elevation
                line_width: 1
                show_fill: false
                show_state: false
                y_axis: secondary
            hour24: true
            hours_to_show: 168
            points_per_hour: 12
            line_width: 2
            lower_bound_secondary: 0
            show:
              extrema: true
              graph: true
              points: false
              legend: true
            animate: false
          - type: 'custom:mini-graph-card'
            name: Humidity
            entities:
              - entity: sensor.downstairs_humidity
                name: Downstairs
                show_state: true
                state_adaptive_color: true
              - entity: sensor.upstairs_humidity
                name: Upstairs
                show_state: true
                state_adaptive_color: true
              - entity: sensor.ecobee_outside_humidity
                name: Outside
                show_state: true
                state_adaptive_color: true
              - color: '#666666'
                entity: sensor.solar_elevation
                line_width: 1
                show_fill: false
                show_state: false
                y_axis: secondary
            hour24: true
            hours_to_show: 168
            points_per_hour: 12
            line_width: 2
            lower_bound_secondary: 0
            show:
              extrema: true
              graph: true
              points: false
              legend: true
            animate: false
          - type: 'custom:mini-graph-card'
            name: Air Pressure
            entities:
              - entity: sensor.ecobee_outside_pressure
                name: Pressure
                show_state: true
                state_adaptive_color: true
              - color: '#666666'
                entity: sensor.solar_elevation
                line_width: 1
                show_fill: false
                show_state: false
                y_axis: secondary
            hour24: true
            hours_to_show: 168
            points_per_hour: 12
            line_width: 2
            lower_bound_secondary: 0
            show:
              extrema: true
              graph: true
              points: false
              legend: false
            animate: false
      - type: vertical-stack
        cards:
          - type: history-graph
            title: "Downstairs"
            hours_to_show: 24
            entities:
              - climate.downstairs
          - type:  history-graph
            title: "Upstairs"
            hours_to_show: 24
            entities:
              - climate.upstairs
  - title: F1
    icon: mdi:car-sports
    cards:
      - type: vertical-stack
        cards:
        - type: picture
          image: /local/f1.jpg
          tap_action:
            action: call-service
            service: script.turn_on
            service_data:
              entity_id: script.roku_espn_tap_action
          # tap_action:
            # action: call-service
            # service: media_player.select_source
            # service_data:
            #   entity_id: media_player.50_tcl_roku_tv
            #   source: "ESPN"
        - type: markdown
          content: > 
            ## {{ states.calendar.f1_all.attributes.message }}
              
            {{ ((as_timestamp(states.calendar.f1_all.attributes.start_time) - as_timestamp(now()))/3600) | round(2) }} hours to go

            Start local: {{ states.calendar.f1_all.attributes.start_time}} 

            Start UTC: {{ as_timestamp(states.calendar.f1_all.attributes.start_time)|timestamp_utc}} 

            ## {{ states.calendar.f1_qualifying.attributes.message }}
            
            {{ ((as_timestamp(states.calendar.f1_qualifying.attributes.start_time) - as_timestamp(now()))/3600) | round(2) }} hours to go
            
            Start local: {{ states.calendar.f1_qualifying.attributes.start_time }}

            Start UTC: {{ as_timestamp(states.calendar.f1_qualifying.attributes.start_time)|timestamp_utc }}

            ## {{ states.calendar.f1_race.attributes.message }}
            
            {{ ((as_timestamp(states.calendar.f1_race.attributes.start_time) - as_timestamp(now()))/3600) | round(2) }} hours to go

            Start local: {{ states.calendar.f1_race.attributes.start_time }}

            Start UTC: {{ as_timestamp(states.calendar.f1_race.attributes.start_time)|timestamp_utc }}
  - title: Commute
    panel: true
    icon: mdi:briefcase
    cards:
      - type: 'custom:mini-graph-card'
        name: Commute
        icon: mdi:briefcase
        hours_to_show: 12
        points_per_hour: 10
        entities:
          - entity: sensor.waze_shankar_work
            name: Shankar
            show_state: true
          - entity: sensor.waze_christine_work
            name: Christine
            show_state: true
        font_size: 75
        show:
          fill: false
  - title: System
    icon: mdi:cog
    cards:
      - type: vertical-stack
        title: People
        cards:
          - type: horizontal-stack
            cards:
              - type: 'custom:uptime-card'
                entity: binary_sensor.shankar_presence
                name: Shankar Presence
                alias:
                  ok: Home
                  ko: Away
                bar:
                  height: 15
                  round: 1
                  spacing: 4
                  amount: 36
                hours_to_show: 168
                show:
                  footer: false
                  average: false
                  header: true
                status_adaptive_color: true
              - type: 'custom:uptime-card'
                entity: binary_sensor.christine_presence
                name: Christine Presence
                alias:
                  ok: Home
                  ko: Away
                bar:
                  height: 15
                  round: 1
                  spacing: 4
                  amount: 36
                hours_to_show: 168
                show:
                  footer: false
                  average: false
                  header: true
                  timeline: true
                status_adaptive_color: true
          - type: 'custom:battery-state-card'
            title: false
            sort_by_level: asc
            entities:
              - entity: sensor.pixel_2_battery_level
                name: 'Pixel 2'
              - entity: sensor.galaxy_s9_battery_level
                name: 'S9'
              - entity: sensor.nexus_7_battery_level
                name: 'Nexus 7'

          - type: 'custom:uptime-card'
            entity: binary_sensor.updater
            icon: 'mdi:raspberry-pi'
            name: HA Update
            alias:
              ok: Update available !
              ko: No update for now
            bar:
              height: 10
              round: 1
              spacing: 4
              amount: 36
            hours_to_show: 168
            show:
              footer: false
            status_adaptive_color: true
          - type: glance
            show_icon: false
            columns: 3
            entities:
              - entity: sensor.count_binary_sensors
                name: Binary Sensors
              - entity: sensor.count_sensors
                name: Sensors
              - entity: sensor.count_switches
                name: Switches
              - entity: sensor.count_device_trackers
                name: Device Trackers
              - entity: sensor.count_automations
                name: Automations
              - entity: sensor.count_scripts
                name: Scripts
      - type: vertical-stack
        title: Router
        cards:
          - type: grid
            columns: 2
            square: false
            cards:
              - type: 'custom:uptime-card'
                entity: device_tracker.front_cam
                icon: 'mdi:cctv'
                ok: home
                ko: away
                alias:
                  ok: Home
                  ko: Away
                name: Front Cam
                bar:
                  height: 15
                  round: 1
                  spacing: 4
                  amount: 36
                show:
                  footer: false
                  timeline: true
              - type: 'custom:uptime-card'
                entity: device_tracker.back_cam
                icon: 'mdi:cctv'
                ok: home
                ko: away
                alias:
                  ok: Home
                  ko: Away
                name: Back Cam
                bar:
                  height: 15
                  round: 1
                  spacing: 4
                  amount: 36
                show:
                  footer: false
                  timeline: true
              - type: 'custom:uptime-card'
                entity: device_tracker.downstairs_wap
                icon: 'mdi:router-wireless'
                ok: home
                ko: away
                alias:
                  ok: Online
                  ko: Offline
                name: Downstairs WAP
                bar:
                  height: 15
                  round: 1
                  spacing: 4
                  amount: 36
                show:
                  footer: false
                  timeline: true
              - type: 'custom:uptime-card'
                entity: device_tracker.upstairs_wap
                icon: 'mdi:router-wireless'
                ok: home
                ko: away
                alias:
                  ok: Online
                  ko: Offline
                name: Upstairs WAP
                bar:
                  height: 15
                  round: 1
                  spacing: 4
                  amount: 36
                show:
                  footer: false
                  timeline: true

          - type: grid
            columns: 3
            square: false
            cards:
              - type: 'custom:mini-graph-card'
                name: CPU
                icon: mdi:server
                hours_to_show: 12
                points_per_hour: 10
                entities:
                  - entity: sensor.mikrotik_cpu_load
                font_size: 75
                show:
                  fill: false
              - type: 'custom:mini-graph-card'
                name: Memory
                font_size: 75
                show:
                  fill: false
                icon: mdi:memory
                hours_to_show: 12
                points_per_hour: 10
                entities:
                  - entity: sensor.mikrotik_memory_usage
              - type: 'custom:mini-graph-card'
                name: HDD
                font_size: 75
                show:
                  fill: false
                icon: mdi:harddisk
                hours_to_show: 12
                points_per_hour: 10
                entities:
                  - entity: sensor.mikrotik_hdd_usage
          - type: 'custom:mini-graph-card'
            name: 'Ether1 Down'
            points_per_hour: 6
            decimals: 1
            font_size: 75
            hours_to_show: 24
            icon: 'mdi:download'
            show:
              graph: line
              extrema: false
            unit: 'MB/s'
            entities:
              - entity: sensor.mikrotik_ether1_rx
                name: Down
              - entity: sensor.mikrotik_ether1_tx
                name: Up
                # color_thresholds:
                #   - color: '#12f395'
                #     value: 0
                #   - color: '#7ff312'
                #     value: 1000
                #   - color: '#dcf312'
                #     value: 5000
                #   - color: '#f3cd12'
                #     value: 10000
                #   - color: '#f31212'
                #     value: 20000
              # - type: 'custom:mini-graph-card'
              #   name: 'Ether1 Up'
              #   points_per_hour: 10
              #   decimals: 1
              #   font_size: 75
              #   hours_to_show: 24
              #   icon: 'mdi:upload'
              #   line_color: '#80e6ff'
              #   show:
              #     graph: line
              #     extrema: true
              #   unit: 'KB/s'
              #   entities:
              #     - sensor.mikrotik_ether1_tx
              #   color_thresholds:
              #     - color: '#12f395'
              #       value: 0
              #     - color: '#7ff312'
              #       value: 200
              #     - color: '#dcf312'
              #       value: 500
              #     - color: '#f3cd12'
              #       value: 1000
              #     - color: '#f31212'
              #       value: 1500
      - type: vertical-stack
        square: false
        title: Internet
        cards:
          - type: entities
            entities:
              - sensor.duckdns_home
              - sensor.myip
              - sensor.speedtest_last_run
          - type: horizontal-stack
            cards: 
              - type: 'custom:mini-graph-card'
                name: 'Internet'
                points_per_hour: 6
                decimals: 1
                font_size: 75
                hours_to_show: 24
                icon: 'mdi:upload'
                # line_color: '#80e6ff'
                show:
                  graph: line
                  extrema: true
                  fill: false
                unit: 'Mbit/sec'
                entities:
                  - sensor.speedtest_download
                  - sensor.speedtest_upload
                # color_thresholds:
                #   - color: '#12f395'
                #     value: 17
                #   - color: '#7ff312'
                #     value: 16
                #   - color: '#dcf312'
                #     value: 15
                #   - color: '#f3cd12'
                #     value: 14
                #   - color: '#f31212'
                #     value: 13 
          - type: 'custom:mini-graph-card'
            name: 'Ping'
            points_per_hour: 6
            decimals: 1
            font_size: 75
            hours_to_show: 24
            # line_color: '#80e6ff'
            show:
              graph: line
              extrema: true
              fill: false
            unit: 'ms'
            entities:
              - sensor.google_ping
              - sensor.cloudflare_ping
            # color_thresholds:
            #   - color: '#f31212'
            #     value: 6
            #   - color: '#f3cd12'
            #     value: 5
            #   - color: '#dcf312'
            #     value: 4 
            #   - color: '#7ff312'
            #     value: 3
            #   - color: '#12f395'
            #     value: 2

  - title: Docker
    icon: mdi:docker
    cards:
      - type: grid
        title: Ubuntu-Server
        square: false
        columns: 2
        cards:
          - type: 'custom:mini-graph-card'
            align_icon: left
            align_state: center
            hours_to_show: 12
            points_per_hour: 10
            entities:
              - sensor.processor_use_percent
            font_size: 75
            icon: 'mdi:chip'
            name: CPU
            show:
              fill: false
          - type: 'custom:mini-graph-card'
            align_icon: left
            align_state: center
            hours_to_show: 12
            points_per_hour: 10
            entities:
              - sensor.memory_use_percent
            font_size: 75
            name: Memory
            show:
              fill: false
          - type: 'custom:mini-graph-card'
            align_icon: left
            align_state: center
            hours_to_show: 12
            points_per_hour: 10
            entities:
              - sensor.disk_use_percent_media_camera
            font_size: 75
            name: Disk Use - USB Video
            show:
              fill: false
          - type: 'custom:mini-graph-card'
            hours_to_show: 12
            points_per_hour: 10
            entities:
              - sensor.processor_temperature
            font_size: 75
            name: Temp 
            show:
              fill: false
      # - type: entities
      #   entities:
      #     - entity: sensor.docker_containers_running
      #       name: Running
      #     - entity: sensor.docker_containers_paused
      #       name: Paused
      #     - entity: sensor.docker_containers_stopped
      #       name: Stopped
      #     - entity: sensor.docker_homeassistant_status
      #       name: HA
      #     - entity:  sensor.docker_version
      #       name: Ver
            
      - type: 'custom:mini-graph-card'
        name: CPU
        hours_to_show: 12
        points_per_hour: 10
        # font_size: 20
        line_width: 1
        show:
          fill: false
          state: true
          labels: true
        entities:
          - entity: sensor.docker_cpu
            name: Docker
          - entity: sensor.docker_homeassistant_cpu
            name: HA
          - entity: sensor.docker_omada_controller_cpu
            name: Omada
          - entity: sensor.docker_signalcli_cpu
            name: Signal
          - entity: sensor.docker_mariadb_homeassistant_cpu
            name: MariaDB
          - entity: sensor.docker_deconz_cpu
            name: Deconz
      - type: 'custom:mini-graph-card'
        name: Mem
        hours_to_show: 12
        points_per_hour: 10
        # font_size: 20
        line_width: 1
        show:
          fill: false
          state: true
          labels: true
        entities:
          - entity: sensor.docker_memory
            name: Docker
          - entity: sensor.docker_homeassistant_memory
            name: HA
          - entity: sensor.docker_omada_controller_memory
            name: Omada
          - entity: sensor.docker_signalcli_memory
            name: Signal
          - entity: sensor.docker_mariadb_homeassistant_memory
            name: MariaDB
          - entity: sensor.docker_deconz_memory
            name: Deconz
  - panel: false
    title: Sensors
    badges: []
    cards:
      - type: entities
        entities:
          - entity: group.water_sensors
          - entity: binary_sensor.attic
          - entity: binary_sensor.laundry
          - entity: binary_sensor.water_heater
        show_header_toggle: true
        title: Water Sensors
      - type: entities
        entities:
          - entity: group.alarm_sensors
          - entity: binary_sensor.basement_door
          - entity: binary_sensor.front_door
          - entity: binary_sensor.back_door
          - entity: binary_sensor.window
        title: Door Sensor
      - type: entities
        entities:
          - entity: sensor.attic_battery_level
          - entity: sensor.laundry_battery_level
          - entity: sensor.water_heater_battery_level
          - entity: sensor.basement_door_battery_level
          - entity: sensor.front_door_battery_level
          - entity: sensor.back_door_battery_level
          - entity: sensor.window_battery_level
        title: Sensor Battery
